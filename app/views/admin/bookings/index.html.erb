<div class="panel panel-default bg-white">

  <div class="panel-body">

    <%= form_tag admin_bookings_path, method: :get do %>

      <div class="row">
        <div class="col-sm-2">
          <%= select_tag :status, options_for_select(Booking.statuses.map { |k,v| ["#{k.humanize.capitalize} (#{Booking.where(status: k).count})", v] }, params[:status]), { include_blank: "All (#{Booking.count})", class: 'form-control' } %>
        </div>
        <div class="col-sm-4">
          <%= submit_tag "Filter", class: 'btn btn-default' %>
        </div>
        <div class="col-sm-6">
          <div class="pull-right">
            <%= paginate @bookings %>
          </div>
        </div>
      </div>

    <% end %>

    <table class="table table-condensed">
      <thead>
        <tr>
          <th>Identifier</th>
          <th>Status</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Created At</th>
        </tr>
      </thead>
      <tbody>
        <% @bookings.each do |booking| %>
        <tr>
          <td>
            <%= link_to booking.try('order_token'), admin_booking_path(booking) %>
          </td>
          <td>
            <%= format_status_label(booking.status) %>
          </td>
          <td>
            <%= booking.user.try('email') %>
          </td>
          <td>
            <%= booking.user.try('phone') %>
          </td>
          <td>
            <%= booking.created_at.strftime("%a, %b %d at %H:%M %Z") %>
          </td>
        </tr>
        <% end %>
      </tbody>
    </table>

  </div>
</div>
